@import "tailwindcss";
@import "react-big-calendar/lib/css/react-big-calendar.css";
@import "react-big-calendar/lib/addons/dragAndDrop/styles.css";
@plugin '@tailwindcss/typography';
@plugin '@tailwindcss/forms';

@custom-variant dark (&:where(html.dark, html.dark *));

:root {
  --background: #f8fafc;
  --foreground: #0f172a;
  --card: #ffffff;
  --card-foreground: #0f172a;
  --popover: #ffffff;
  --popover-foreground: #0f172a;
  --primary: #0f172a;
  --primary-foreground: #ffffff;
  --secondary: #f1f5f9;
  --secondary-foreground: #0f172a;
  --muted: #f1f5f9;
  --muted-foreground: #64748b;
  --accent: #f1f5f9;
  --accent-foreground: #0f172a;
  --destructive: #ef4444;
  --destructive-foreground: #ffffff;
  --border: #e2e8f0;
  --input: #e2e8f0;
  --ring: #be9124;
  --radius: 0.75rem;

  /* Z-Index Scale */
  --z-nav: 40;
  --z-header: 50;
  --z-prompt: 60;
  --z-sheet: 70;
  --z-toast: 80;
  --z-max: 100;

  --shell-text: #0f172a;
  --shell-text-muted: #475569;
  --shell-text-soft: #64748b;
  --shell-card-bg: #ffffff;
  --shell-panel-bg: #f1f5f9;
  --shell-panel-hover: #e2e8f0;
  --shell-border: #e2e8f0;
  --shell-border-soft: #cbd5e1;
  --shell-shadow: 0 4px 12px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.1);
  --shell-shadow-pressed: inset 2px 2px 4px rgba(0, 0, 0, 0.06), inset -2px -2px 4px rgba(255, 255, 255, 0.8);
  --shell-gold: #926c15;
  --shell-gold-soft: rgba(146, 108, 21, 0.1);
  --shell-chart-grid: #e2e8f0;
  --shell-chart-cursor: rgba(146, 108, 21, 0.05);
  --shell-avatar-bg: #e2e8f0;
  --shell-avatar-inner-from: #f8fafc;
  --shell-avatar-inner-to: #e2e8f0;

  --shell-tone-green-bg: #f0fdf4;
  --shell-tone-green-border: #bbf7d0;
  --shell-tone-green-text: #15803d;
  --shell-tone-yellow-bg: #fefce8;
  --shell-tone-yellow-border: #fef08a;
  --shell-tone-yellow-text: #a16207;
  --shell-tone-red-bg: #fef2f2;
  --shell-tone-red-border: #fecaca;
  --shell-tone-red-text: #b91c1c;
  --shell-tone-blue-bg: #eff6ff;
  --shell-tone-blue-border: #bfdbfe;
  --shell-tone-blue-text: #1d4ed8;
  --shell-warn-bg: #fffbeb;
  --shell-warn-border: #fef3c7;
  --shell-danger-bg: #fff1f2;
  --shell-danger-border: #ffe4e6;

  --shell-font-serif: var(--font-playfair), "Times New Roman", serif;
  --shell-font-sans: var(--font-plus-jakarta), var(--font-geist-sans), Arial, Helvetica, sans-serif;
}

html.dark:root {
  --background: #000000;
  --foreground: #ededed;
  --card: #0a0a0a;
  --card-foreground: #ededed;
  --popover: #0a0a0a;
  --popover-foreground: #ededed;
  --primary: #ededed;
  --primary-foreground: #0a0a0a;
  --secondary: #121212;
  --secondary-foreground: #ededed;
  --muted: #121212;
  --muted-foreground: #94979f;
  --accent: #121212;
  --accent-foreground: #ededed;
  --destructive: #7f1d1d;
  --destructive-foreground: #ededed;
  --border: rgba(212, 175, 55, 0.22);
  --input: rgba(212, 175, 55, 0.14);
  --ring: #d4af37;

  --shell-text: #f4f4f5;
  --shell-text-muted: #94979f;
  --shell-text-soft: #adb0b8;
  --shell-card-bg: linear-gradient(145deg, #131313, #060606);
  --shell-panel-bg: #0a0a0a;
  --shell-panel-hover: #101010;
  --shell-border: rgba(212, 175, 55, 0.22);
  --shell-border-soft: rgba(212, 175, 55, 0.14);
  --shell-shadow: 0 12px 28px rgba(0, 0, 0, 0.48), inset 0 1px 0 rgba(212, 175, 55, 0.12);
  --shell-shadow-pressed: inset 6px 6px 12px rgba(0, 0, 0, 0.45), inset -2px -2px 8px rgba(212, 175, 55, 0.05);
  --shell-gold: #d4af37;
  --shell-gold-soft: rgba(212, 175, 55, 0.14);
  --shell-chart-grid: rgba(212, 175, 55, 0.18);
  --shell-chart-cursor: rgba(212, 175, 55, 0.18);
  --shell-avatar-bg: #121212;
  --shell-avatar-inner-from: #1b1b1b;
  --shell-avatar-inner-to: #000000;

  --shell-tone-green-bg: rgba(34, 197, 94, 0.14);
  --shell-tone-green-border: rgba(34, 197, 94, 0.3);
  --shell-tone-green-text: #22c55e;
  --shell-tone-yellow-bg: rgba(245, 158, 11, 0.14);
  --shell-tone-yellow-border: rgba(245, 158, 11, 0.3);
  --shell-tone-yellow-text: #f59e0b;
  --shell-tone-red-bg: rgba(244, 63, 94, 0.14);
  --shell-tone-red-border: rgba(244, 63, 94, 0.3);
  --shell-tone-red-text: #f43f5e;
  --shell-tone-blue-bg: rgba(59, 130, 246, 0.14);
  --shell-tone-blue-border: rgba(59, 130, 246, 0.3);
  --shell-tone-blue-text: #60a5fa;
  --shell-warn-bg: rgba(245, 158, 11, 0.1);
  --shell-warn-border: rgba(245, 158, 11, 0.24);
  --shell-danger-bg: rgba(244, 63, 94, 0.1);
  --shell-danger-border: rgba(244, 63, 94, 0.24);
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --radius-radius: var(--radius);
  --font-sans: var(--shell-font-sans);
  --font-serif: var(--shell-font-serif);
  --font-mono: var(--font-geist-mono), ui-monospace;
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: var(--shell-font-sans);
  -webkit-tap-highlight-color: rgba(59, 130, 246, 0.25);
  touch-action: manipulation;
}

.pb-safe {
  padding-bottom: max(1rem, env(safe-area-inset-bottom));
}

.pt-safe {
  padding-top: env(safe-area-inset-top);
}

.dashboard-shell {
  /* Themed via :root and html.dark:root variables */
}

h1.dash-title {
  font-family: var(--shell-font-serif);
  color: var(--shell-gold);
  letter-spacing: 0.01em;
}

.dash-text { color: var(--shell-text); }
.dash-text-muted { color: var(--shell-text-muted); }
.dash-text-soft { color: var(--shell-text-soft); }
.dash-text-danger { color: var(--shell-tone-red-text); }

.dash-link { color: var(--shell-gold); }
.dash-link:hover { opacity: 0.9; }
.gold-text {
  color: var(--shell-gold);
  text-shadow: 0 0 8px rgba(212, 175, 55, 0.25);
}

.dash-card {
  border-color: var(--shell-border);
  background: var(--shell-card-bg);
  box-shadow: var(--shell-shadow);
}

.dash-card.bg-card,
.dash-card[class*="bg-card"] {
  background: var(--shell-card-bg);
}

.dash-card.border { border-color: var(--shell-border); }
.dash-card.shadow-sm { box-shadow: var(--shell-shadow); }

.dash-card-warn { border-color: var(--shell-warn-border); background: var(--shell-warn-bg); }
.dash-card-danger { border-color: var(--shell-danger-border); background: var(--shell-danger-bg); }

.dash-inline-card { border-color: var(--shell-border-soft); background: var(--shell-card-bg); }
.dash-inline-card.border { border-color: var(--shell-border-soft); }
.dash-bg-card { background: var(--shell-card-bg); }
.dash-bg-panel { background: var(--shell-panel-bg); }
.dash-border { border-color: var(--shell-border-soft); }

.dash-action-link { border-color: var(--shell-border-soft); background: var(--shell-card-bg); }
.dash-action-link:hover .dash-action-title { color: var(--shell-gold); }
.dash-action-icon { background: var(--shell-gold-soft); color: var(--shell-gold); }
.dash-action-title { color: var(--shell-text); }

.dash-skeleton { background: color-mix(in srgb, var(--shell-text-soft) 35%, transparent); }
.dash-kbd { border-color: var(--shell-border-soft); color: var(--shell-text-soft); }
.dash-stat-chip {
  color: var(--shell-tone-green-text);
  background: var(--shell-tone-green-bg);
  border-color: var(--shell-tone-green-border);
}

.dash-chip-tone-green { border-color: var(--shell-tone-green-border); background: var(--shell-tone-green-bg); color: var(--shell-tone-green-text); }
.dash-chip-tone-yellow { border-color: var(--shell-tone-yellow-border); background: var(--shell-tone-yellow-bg); color: var(--shell-tone-yellow-text); }
.dash-chip-tone-red { border-color: var(--shell-tone-red-border); background: var(--shell-tone-red-bg); color: var(--shell-tone-red-text); }
.dash-chip-tone-blue { border-color: var(--shell-tone-blue-border); background: var(--shell-tone-blue-bg); color: var(--shell-tone-blue-text); }

.dash-reminder-done { border-color: var(--shell-tone-green-border); background: var(--shell-tone-green-bg); color: var(--shell-tone-green-text); }
.dash-reminder-snooze { border-color: var(--shell-tone-yellow-border); background: var(--shell-tone-yellow-bg); color: var(--shell-tone-yellow-text); }

.dash-shell-header { border-color: var(--shell-border-soft); background: var(--shell-panel-bg); }
.dash-shell-email { color: var(--shell-text-muted); }
.dash-shell-main { background: transparent; }
.dash-shell-search-icon { color: var(--shell-text-soft); }
.dash-shell-tier { color: var(--shell-text-soft); }
.dash-shell-avatar-ring {
  border-color: color-mix(in srgb, var(--shell-gold) 40%, transparent);
  background: var(--shell-avatar-bg);
}
.dash-shell-avatar-inner {
  background: linear-gradient(135deg, var(--shell-avatar-inner-from), var(--shell-avatar-inner-to));
}
.dash-shell-avatar-text {
  color: color-mix(in srgb, var(--shell-text-soft) 85%, var(--shell-gold) 15%);
}

.dash-sidebar { border-color: var(--shell-border-soft); background: var(--shell-panel-bg); }
.dash-sidebar-header { border-color: var(--shell-border-soft); }
.dash-sidebar-brand { color: var(--shell-gold); }
.dash-sidebar-link { color: var(--shell-text-muted); }
.dash-sidebar-link:hover { color: var(--shell-text); background: color-mix(in srgb, var(--shell-gold-soft) 45%, transparent); }
.dash-sidebar-link-active { color: var(--shell-text); background: color-mix(in srgb, var(--shell-gold-soft) 70%, transparent); }
.dash-sidebar-conflict-badge { border-color: var(--shell-tone-red-border); background: var(--shell-tone-red-bg); color: var(--shell-tone-red-text); }

.dash-mobile-nav { border-color: var(--shell-border-soft); background: var(--shell-panel-bg); }
.dash-mobile-nav-link { color: var(--shell-text-muted); }
.dash-mobile-nav-link-inactive { color: var(--shell-text-muted); }
.dash-mobile-nav-link-active { color: var(--shell-gold); }
.dash-mobile-fab {
  border-color: color-mix(in srgb, var(--shell-gold) 40%, transparent);
  background: var(--shell-card-bg);
  color: var(--shell-gold);
  box-shadow: 0 12px 24px color-mix(in srgb, var(--shell-gold) 45%, transparent);
}

.dash-mobile-header { border-color: var(--shell-border-soft); background: var(--shell-panel-bg); }
.dash-mobile-drawer { border-color: var(--shell-border-soft); background: var(--shell-card-bg); }
.dash-mobile-drawer-header { border-color: var(--shell-border-soft); }
.dash-mobile-drawer-link { color: var(--shell-text); }
.dash-mobile-drawer-link:hover { background: color-mix(in srgb, var(--shell-gold-soft) 45%, transparent); }
.dash-mobile-icon { color: var(--shell-text-muted); }
.dash-mobile-brand-icon { color: var(--shell-gold); }

.dash-shell-icon-btn { color: var(--shell-text-muted); }
.dash-shell-icon-btn:hover { color: var(--shell-text); background: color-mix(in srgb, var(--shell-gold-soft) 55%, transparent); }
.dash-shell-text-btn { color: var(--shell-text-muted); }
.dash-shell-text-btn:hover { color: var(--shell-text); background: color-mix(in srgb, var(--shell-gold-soft) 45%, transparent); }
.dash-shell-primary-btn { border-color: var(--shell-border); background: var(--shell-gold-soft); color: var(--shell-gold); }
.dash-shell-primary-btn:hover { background: color-mix(in srgb, var(--shell-gold-soft) 75%, transparent); }

.dash-chart-grid { stroke: var(--shell-chart-grid); }
.dash-chart-dots {
  background-image: radial-gradient(circle at 2px 2px, color-mix(in srgb, var(--shell-gold) 88%, transparent) 1px, transparent 0);
  background-size: 24px 24px;
}
.dash-chart-tooltip {
  background-color: var(--shell-panel-hover);
  border-radius: 12px;
  border: 1px solid var(--shell-border);
}
.dash-chart-tooltip-item { color: var(--shell-gold); }

.pillowy-card {
  background: var(--shell-card-bg);
  box-shadow: var(--shell-shadow);
  border-radius: 32px;
  border: 1px solid var(--shell-border);
}
.pillowy-card-pressed {
  background: var(--shell-panel-bg);
  box-shadow: var(--shell-shadow-pressed);
  border-radius: 24px;
}
.icon-3d-gold {
  background: linear-gradient(135deg, #f9e29c 0%, var(--shell-gold) 45%, #8a6d3b 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.8));
}
.nav-3d-active {
  border: 1px solid color-mix(in srgb, var(--shell-gold) 40%, transparent);
  box-shadow: inset 2px 2px 5px rgba(0, 0, 0, 0.2);
}

/* Legacy utility bridge removed to prevent theme interference */

@layer components {
  .touch-target {
    @apply min-h-[44px] min-w-[44px] flex items-center justify-center;
  }
}

/* Calendar fixes (react-big-calendar under dashboard skin) */
.calendar-shell .rbc-calendar {
  background: var(--shell-card-bg);
  color: var(--shell-text);
  font-family: var(--shell-font-sans);
}

.calendar-shell .rbc-toolbar {
  display: none;
}

.calendar-shell .rbc-month-view,
.calendar-shell .rbc-time-view,
.calendar-shell .rbc-agenda-view {
  border-color: var(--shell-border-soft);
  background: var(--shell-card-bg);
  border-radius: 12px;
  overflow: hidden;
}

.calendar-shell .rbc-header {
  padding: 12px 4px;
  font-weight: 600;
  text-transform: uppercase;
  font-size: 0.7rem;
  letter-spacing: 0.05em;
  color: var(--shell-text-muted);
  border-bottom: 1px solid var(--shell-border-soft);
}

.calendar-shell .rbc-time-header-content,
.calendar-shell .rbc-timeslot-group,
.calendar-shell .rbc-day-bg,
.calendar-shell .rbc-time-content > * + * > * {
  border-color: var(--shell-border-soft);
}

.calendar-shell .rbc-month-row {
  border-color: var(--shell-border-soft);
}

.calendar-shell .rbc-off-range-bg {
  background: color-mix(in srgb, var(--shell-panel-bg) 40%, transparent);
}

.calendar-shell .rbc-today {
  background: color-mix(in srgb, var(--shell-gold-soft) 25%, transparent);
}

.calendar-shell .rbc-event {
  border: none;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  transition: transform 0.1s ease;
}

.calendar-shell .rbc-event:active {
  transform: scale(0.98);
}

.calendar-shell .rbc-event-label {
  font-size: 0.7rem;
  opacity: 0.8;
}

.calendar-shell .rbc-event-content {
  font-size: 0.75rem;
  font-weight: 500;
}

.calendar-shell .rbc-show-more {
  background: transparent;
  color: var(--shell-gold);
  font-size: 0.7rem;
  font-weight: 600;
}

.calendar-shell .rbc-label,
.calendar-shell .rbc-date-cell,
.calendar-shell .rbc-agenda-date-cell,
.calendar-shell .rbc-agenda-time-cell {
  color: var(--shell-text-muted);
  padding: 4px 8px;
}

.calendar-shell .rbc-now {
  color: var(--shell-gold);
  font-weight: bold;
}

.calendar-shell .rbc-agenda-view table.rbc-agenda-table {
  border: 1px solid var(--shell-border-soft);
}

.calendar-shell .rbc-agenda-view table.rbc-agenda-table thead > tr > th {
  border-bottom: 1px solid var(--shell-border-soft);
  color: var(--shell-text);
}

.calendar-shell .rbc-agenda-view table.rbc-agenda-table tbody > tr > td {
  border-color: var(--shell-border-soft);
}

/* Custom scrollbar for agenda and time views */
.calendar-shell .rbc-time-content::-webkit-scrollbar,
.calendar-shell .rbc-agenda-content::-webkit-scrollbar {
  width: 6px;
}

.calendar-shell .rbc-time-content::-webkit-scrollbar-thumb,
.calendar-shell .rbc-agenda-content::-webkit-scrollbar-thumb {
  background-color: var(--shell-border-soft);
  border-radius: 10px;
}

@media (max-width: 768px) {
  .calendar-shell .rbc-header {
    padding: 8px 2px;
    font-size: 0.6rem;
    letter-spacing: 0.03em;
  }

  .calendar-shell .rbc-date-cell {
    padding: 2px 4px;
    font-size: 0.72rem;
  }

  .calendar-shell .rbc-event {
    border-radius: 6px;
    padding: 1px 3px;
  }

  .calendar-shell .rbc-event-label {
    font-size: 0.62rem;
  }

  .calendar-shell .rbc-event-content {
    font-size: 0.65rem;
    line-height: 1.1;
  }

  .calendar-shell .rbc-agenda-view .rbc-agenda-table {
    font-size: 0.75rem;
  }
}
